var t=Object.defineProperty,e=(e,s,i)=>(((e,s,i)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i})(e,"symbol"!=typeof s?s+"":s,i),i);import{P as s}from"./phaser.39311b5c.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class i extends Phaser.Scene{constructor(){super("Boot")}preload(){this.load.setPath("./assets"),this.load.image("menu-bg","menu-bg.jpg"),this.load.image("loading-bar","loading-bar.png")}create(){this.scene.start("Preload")}}const a=t=>Phaser.Display.Color.HexStringToColor(t),h={white:a("#FFFFFF"),black:a("#000000"),gray:a("#696969"),loadingBar:a("#dd6b20")},n=t=>{const{height:e,width:s}=t.scale;return new Phaser.Geom.Rectangle(0,0,s,e)};class r extends Phaser.GameObjects.Sprite{constructor(t,s,i){const{onComplete:a,revealYOffset:r=50}=i||{};super(t,0,0,s),e(this,"progress"),e(this,"progressValue",50),e(this,"text"),e(this,"initialLoadAnimationComplete",!1),e(this,"finished",!1),e(this,"xPadding",20),e(this,"yPadding",10),e(this,"revealYOffset"),e(this,"onComplete"),this.revealYOffset=r,this.onComplete=a,this.setAlpha(0),t.add.existing(this),this.text=t.add.text(0,0,["Loading..."],{fontSize:70,align:"center",fontFamily:"Arial",stroke:h.loadingBar.rgba,strokeThickness:5,color:h.black.rgba}).setOrigin(.5,.5).setAlpha(0),((t,e,s)=>{const{gap:i=0,offset:a}=s||{},h=(null==a?void 0:a.y)||0,r=(null==a?void 0:a.x)||0;let o=i;for(const n of e)o+=n.displayHeight;const{centerX:l,centerY:c}=n(t),d=e.length;let g=-o/d;for(const n of e)n.setPosition(l+r,c+g+n.displayHeight/d+h),g+=n.displayHeight+i})(t,[this.text,this],{gap:20,offset:{y:-this.revealYOffset}}),this._initReveal(),this.scene.load.on("progress",this._handleLoadProgress,this)}_initReveal(){this._animateReveal(this.text),this._animateReveal(this,{delay:150,onComplete:()=>this._initLoading()})}_initLoading(){this.progress=this.scene.add.graphics(),this._tweenLoading({from:0,to:50,onComplete:()=>{this.initialLoadAnimationComplete=!0,this.finished||1!==this.progressValue||this._tweenLoading({from:51,to:100,onComplete:()=>this._finish()})}})}_handleLoadProgress(t){this.progressValue=t,this.initialLoadAnimationComplete&&(this.fillProgressToPercent(t),1===t&&this._finish())}fillProgressToPercent(t){this.progress.clear(),this.progress.fillStyle(h.loadingBar.color,1),this.progress.fillRect(this.x-.5*this.width+this.xPadding,this.y-.5*this.height+this.yPadding,(this.width-2*this.xPadding)*t,this.height-2*this.yPadding)}_finish(){this.finished=!0,this.scene.time.delayedCall(500,(()=>{var t;null==(t=this.onComplete)||t.call(this)}))}_tweenLoading(t){this.scene.tweens.addCounter({from:t.from,to:t.to,duration:250,onUpdate:t=>{this.fillProgressToPercent(t.getValue()/100)},onComplete:()=>{var e;null==(e=null==t?void 0:t.onComplete)||e.call(t)},callbackScope:this})}_animateReveal(t,e){const{duration:s=500,onComplete:i,...a}=e||{};this.scene.tweens.add({targets:t,alpha:1,duration:s,y:t.y+this.revealYOffset,ease:t=>Phaser.Math.Easing.Back.Out(t,.1*this.revealYOffset),callbackScope:this,onComplete:i,...a})}}class o extends Phaser.Scene{constructor(){super("Preload"),e(this,"loadingBar")}preload(){this.add.sprite(0,0,"menu-bg").setOrigin(0,0),this.loadingBar=new r(this,"loading-bar",{onComplete:()=>{var t;(t=this).cameras.main.fadeOut(250),t.time.addEvent({delay:250,callback:function(){t.scene.start("Game")},callbackScope:t})}}),this.load.setPath("./assets"),this.load.image("court","court.jpg"),this.load.image("seats","seats.png"),this.load.image("barrier","barrier.jpg"),this.load.image("invisible","invisible.png"),this.load.image("ball","ball.png"),this.load.image("backboard","backboard.jpg"),this.load.image("shoot-particle","shoot-particle.png"),this.load.image("mast","mast.png"),this.load.image("rim","rim.png"),this.load.atlas("net","net.png","net.json"),this.loadAudio("score"),this.loadAudio("shoot"),this.loadAudio("net")}create(){this.input.on("pointerdown",(()=>{this.scene.restart()}),this)}loadAudio(t){this.load.audio(t,[".mp3",".ogg",".m4a"].map((e=>`${t}${e}`)))}}class l{constructor(t){e(this,"ballAtApex"),e(this,"ballReset"),e(this,"score"),this.ballAtApex=new c(t,"BALL_AT_APEX"),this.ballReset=new c(t,"BALL_RESET"),this.score=new c(t,"SCORE")}}class c{constructor(t,s){e(this,"_scene"),e(this,"_name"),this._scene=t,this._name=s}fire(...t){this._scene.events.emit(this._name,...t)}listen(t,e){this._scene.events.on(this._name,t,e)}stop(t,e){this._scene.events.on(this._name,t,e)}}class d extends Phaser.GameObjects.Container{constructor(t,s,i){super(t,s,i),e(this,"gameEvents"),e(this,"animation"),e(this,"image"),e(this,"leftWall"),e(this,"rightWall"),e(this,"scoreIndicator"),this.gameEvents=new l(this.scene),this.setVisible(!1),t.add.existing(this),this._init()}_init(){this.image=this.scene.physics.add.sprite(0,0,"net").setScale(.75).setOrigin(0,0),this.setDepth(3);const t=this.image.displayWidth,e=-t/2;this.image.setX(e),this.add(this.image),this._initAnimation(),this.leftWall=this._addWall(e+5),this.rightWall=this._addWall(e+t-5),this.gameEvents.score.listen((()=>{this._animate(),this.scene.sound.play("net")}),this),this.setVisible(!0)}_initAnimation(){this.animation=this.image.anims.create({key:"net",frames:this.image.anims.generateFrameNames("net",{prefix:"net-",suffix:".png",start:1,end:5,zeroPad:2}),frameRate:15,repeat:0})}handleBallCollision(t){this._handleWallCollision(t,this.leftWall),this._handleWallCollision(t,this.rightWall)}disableDebugDisplay(){this.leftWall.body.debugShowBody=!1,this.rightWall.body.debugShowBody=!1,this.image.body.debugShowBody=!1}_animate(){this.image.play(this.animation,!0)}_addWall(t){const e=this.scene.physics.add.sprite(t,15,"invisible").setBodySize(1,this.image.displayHeight-15,!1).setImmovable(!0).setDebugBodyColor(65280).refreshBody();return this.add(e),e}_handleWallCollision(t,e){this.scene.physics.add.collider(t,e,(()=>{t.setVelocityX(-t.body.velocity.x)}),(()=>t.body.velocity.y>=0),this)}}class g extends Phaser.GameObjects.Container{constructor(t,s,i){super(t,s,i),e(this,"gameEvents"),e(this,"frontRim"),e(this,"leftRim"),e(this,"rightRim"),e(this,"scoreIndicator"),e(this,"justScored",!1),this.gameEvents=new l(this.scene),this.setVisible(!1),t.add.existing(this),this._init()}_init(){this.setDepth(2),this.frontRim=this.scene.add.image(0,0,"rim").setOrigin(0,0).setScale(2).setVisible(!0);const t=this.frontRim.displayWidth,e=-t/2;this.frontRim.setX(e),this.add(this.frontRim),this.leftRim=this._addSideRim(e),this.rightRim=this._addSideRim(e+.9*t),this.scoreIndicator=this.scene.physics.add.sprite(e+10,20,"invisible").setBodySize(t-20,1,!1).setOrigin(0,0).setDebugBodyColor(65280),this.add(this.scoreIndicator),this.setVisible(!0),this.gameEvents.ballReset.listen(this._handleBallReset,this)}handleBallCollision(t){this._handleSideRimCollision(t,this.leftRim),this._handleSideRimCollision(t,this.rightRim),this._listenForScore(t)}_listenForScore(t){t.scene.physics.add.overlap(t,this.scoreIndicator,(()=>{t.justScored||(t.justScored=!0,this.gameEvents.score.fire())}),(()=>t.body.velocity.y>=0),this)}_addSideRim(t){const e=this.scene.physics.add.sprite(t,0,"rim").setOrigin(0,0).setScale(.2,2).setImmovable(!0).setDebugBodyColor(65280).refreshBody();return e.body.setCircle(e.displayWidth/2),this.add(e),e}_handleSideRimCollision(t,e){this.scene.physics.add.collider(t,e,null,(()=>t.body.velocity.y>=0),this)}_handleBallReset(){this.justScored=!1}}class p extends Phaser.GameObjects.Group{constructor(t){super(t),e(this,"leftMast"),e(this,"rightMast"),e(this,"board"),e(this,"rim"),e(this,"net"),this.setVisible(!1),t.add.existing(this),this._init()}_init(){const t=n(this.scene);this.board=this.scene.add.image(t.centerX,50,"backboard").setOrigin(.5,0).setDepth(1),this.add(this.board);const e=this.board.getBottomCenter();this.rim=new g(this.scene,e.x,e.y-50).setDepth(2),this.add(this.rim),this.net=new d(this.scene,e.x,this.rim.y+3).setDepth(3),this.add(this.net);const s=this.board.getTopLeft();this.leftMast=this._addMast(s.x+50,s.y+20).setOrigin(0,1);const i=this.board.getTopRight();this.rightMast=this._addMast(i.x-50,i.y+20).setOrigin(1,1),this.setVisible(!0)}handleBallCollision(t){this.rim.handleBallCollision(t),this.net.handleBallCollision(t)}_addMast(t,e){const s=this.scene.add.image(t,e,"mast").setScale(.5).setDepth(1).setTint(16777215);return this.add(s),s}}const m=new class{constructor({rawMin:t,rawMax:s,scaleMin:i,scaleMax:a}){e(this,"rawMin"),e(this,"rawMax"),e(this,"scaleMin"),e(this,"scaleMax"),this.rawMin=t,this.rawMax=s,this.scaleMin=i,this.scaleMax=a}reverseInterpolate(t){return this.rawMin*(1-t)+this.rawMax*t}interpolate(t){return this.scaleMin*(1-t)+this.scaleMax*t}uninterpolate(t){const e=this.rawMax-this.rawMin!=0?this.rawMax-this.rawMin:1/this.rawMax;return(t-this.rawMin)/e}reverseUninterpolate(t){const e=this.scaleMax-this.scaleMin!=0?this.scaleMax-this.scaleMin:1/this.scaleMax;return(t-this.scaleMin)/e}scale(t){return t<this.rawMin&&(t=this.rawMin),t>this.rawMax&&(t=this.rawMax),this.interpolate(this.uninterpolate(t))}reverseScale(t){return t<this.scaleMin&&(t=this.scaleMin),t>this.scaleMax&&(t=this.scaleMax),this.reverseInterpolate(this.reverseUninterpolate(t))}}({rawMin:-1e3,rawMax:1e3,scaleMin:-200,scaleMax:200});class u extends Phaser.Physics.Arcade.Sprite{constructor(t,s,i){super(t,s,i,"ball",0),e(this,"gameEvents"),e(this,"animation"),e(this,"start"),e(this,"end"),e(this,"isDown",!1),e(this,"isLaunched",!1),e(this,"hasReachedApex",!1),e(this,"justScored",!1),e(this,"startTrackTimeEvent"),e(this,"idlePosition"),e(this,"idleScale",1.5),e(this,"launchScale",.9),e(this,"launchParticles"),this.gameEvents=new l(t),this.idlePosition=new Phaser.Math.Vector2(s,i),t.add.existing(this),t.physics.add.existing(this),this._init()}_init(){this.setDepth(4),this.setScale(this.idleScale),this.body.setCircle(this.width/2),this.setBounceY(1),this.setBounceX(.8),this.setInteractive({cursor:"grab"}),this._initLaunchParticles(),this._listenForInputs(),this.scene.events.on(Phaser.Scenes.Events.UPDATE,this.update,this)}_initLaunchParticles(){this.launchParticles=this.scene.add.particles(null,null,"shoot-particle",{quantity:10,tint:h.white.color,color:[h.white.color],speedY:{min:20,max:50},lifespan:{min:100,max:300},alpha:{start:.5,end:0,ease:"Sine.easeIn"},scale:{start:.3,end:.1},frequency:30,blendMode:Phaser.BlendModes.ADD,follow:this,followOffset:{y:this.height/2,x:0},delay:0})}update(t,e){this.isLaunched&&!this.hasReachedApex&&this.body.velocity.y>0&&(this.hasReachedApex=!0,this.launchParticles.stop(),this.gameEvents.ballAtApex.fire()),this.isLaunched&&this.y>this.scene.scale.height+250&&(this.gameEvents.ballReset.fire(),this._reset())}_handleDragStart(t){this.scene.game.canvas.style.cursor="grabbing",this.isDown=!0,this.startTrackTimeEvent=this.scene.time.addEvent({delay:200,callback:()=>{this.start=new Phaser.Math.Vector2(t.x,t.y)},callbackScope:this,loop:!0}),this._tween({scale:1.1*this.idleScale,duration:100}),this.start=new Phaser.Math.Vector2(t.x,t.y)}_handleDragEnd(t){if(this.startTrackTimeEvent&&this.startTrackTimeEvent.destroy(),this.isDown)if(this.isDown=!1,this.end=new Phaser.Math.Vector2(t.x,t.y),this.end.y<this.start.y){const t=new Phaser.Math.Vector2(this.end.x-this.start.x,this.end.y-this.start.y);var e=-2300*t.x/t.y;this._launch(e)}else this._tween({scale:this.idleScale,duration:100}),this.scene.game.canvas.style.cursor="grab";else this._tween({scale:this.idleScale,duration:100})}_launch(t){this._stopListeningForInputs(),this.isLaunched=!0,this.hasReachedApex=!1,this.launchParticles.start(),this.scene.sound.play("shoot"),t=m.scale(t),this.setGravityY(1800),this.setVelocityY(-1750),this.setVelocityX(t),this.setRotation(t/3),this._tween({scale:this.launchScale,rotation:t>0?Math.PI/4:-Math.PI/4,duration:800})}_reset(){this.isLaunched=!1,this.isDown=!1,this.hasReachedApex=!1,this.justScored=!1,this.setDepth(4),this.setGravityY(0),this.setVelocity(0,0),this.setRotation(0),this.setScale(this.idleScale),this.setPosition(this.idlePosition.x,this.scene.scale.height+this.height),this._tween({y:this.idlePosition.y,duration:300,ease:Phaser.Math.Easing.Sine.InOut,onComplete:()=>{this._listenForInputs()}})}_listenForInputs(){this.on("pointerdown",this._handleDragStart,this),this.scene.input.on("pointerup",this._handleDragEnd,this),this.scene.input.on("pointerupoutside",this._handleDragEnd,this)}_stopListeningForInputs(){this.off("pointerdown",this._handleDragStart,this),this.scene.input.off("pointerup",this._handleDragEnd,this),this.scene.input.off("pointerupoutside",this._handleDragEnd,this)}_tween(t){this.scene.tweens.add({targets:this,ease:Phaser.Math.Easing.Linear,...t})}}const y=(t,e=0)=>{var s;const i=(t=>{var e;if(!t)throw new Error("Key not specified");try{const e=localStorage.getItem(t);return null!==e?e:void 0}catch(s){console.error(`Error getting ${t} from local storage. Error: ${null==(e=s||"")?void 0:e.toString()}`,{key:t},s)}})(t);if(!i)return e;try{const t=parseInt(i);return isNaN(t)?e:t}catch(a){console.error(`Error parsing ${i} from key ${t} to int from local storage. Error: ${null==(s=a||"")?void 0:s.toString()}`,{stringValue:i,key:t},a)}return e};class b extends Phaser.GameObjects.Container{constructor(t){super(t,0,0),e(this,"gameEvents"),e(this,"bestScoreKey","hoop_bestScore"),e(this,"currentText"),e(this,"bestText"),e(this,"best",0),e(this,"current",0),e(this,"interval",25),e(this,"delta",0),this.gameEvents=new l(this.scene),t.add.existing(this),t.physics.add.existing(this),this.init()}init(){this.scene.sound.add("score"),this.best=y(this.bestScoreKey);const t=this.scene.scale.width;this.currentText=this.scene.add.text(5,0,"Score: 0",{fontSize:25,fontFamily:"Arial",color:"#FFFFFF"}).setOrigin(0,0),this.bestText=this.scene.add.text(t-5,0,"Best: "+this.best.toLocaleString(),{fontSize:25,fontFamily:"Arial",color:"#FFFFFF"}).setOrigin(1,0),this.add([this.currentText,this.bestText]).setDepth(4),this.gameEvents.score.listen(this._handleScore,this)}_handleScore(){++this.current,this.scene.time.delayedCall(500,(()=>this.scene.sound.play("score")),null,this),this.currentText.text="Score: "+this.current.toLocaleString(),this.current>this.best&&(this.best=this.current,this.bestText.text="Best: "+this.best.toLocaleString(),((t,e)=>{if(!t)throw new Error("Key not specified");try{localStorage.setItem(t,e.toString())}catch(s){console.error("Failed to set local storage",{key:t,value:e},s)}})(this.bestScoreKey,this.best)),this.scene.tweens.add({targets:this.currentText,duration:100,scale:1.1,repeat:2,alpha:0,yoyo:!0})}}class f extends Phaser.Scene{constructor(){super("Game"),e(this,"gameEvents"),e(this,"isBallBelowHoop",!0),e(this,"backboard"),e(this,"ball"),e(this,"court"),e(this,"barrier"),e(this,"seats"),e(this,"score"),this.gameEvents=new l(this)}get height(){return this.scale.height}get width(){return this.scale.width}get center(){return{x:this.width/2,y:this.height/2}}create(){this.cameras.main.fadeIn(250),this.initEnvironment(),this.score=new b(this),this.backboard=new p(this),this.ball=new u(this,this.center.x,this.height-200).setOrigin(.5,.5),this.backboard.handleBallCollision(this.ball),this.gameEvents.ballAtApex.listen((()=>{this.ball.setDepth(this.backboard.net.depth-1)}),this)}update(t,e){}initEnvironment(){this.seats=this.add.image(0,0,"seats").setOrigin(0,0).setDepth(0),this.barrier=this.add.image(0,this.seats.height-28,"barrier").setOrigin(0,0).setDepth(1),this.court=this.add.image(0,this.height-586,"court").setOrigin(.23,0).setDepth(1)}}const w={type:s.AUTO,width:800,height:1250,max:{width:550,height:859.375},min:{width:350,height:546.875},input:{mouse:{target:window}},parent:"game-container",pixelArt:!1,physics:{default:"arcade",arcade:{debug:!1}},scale:{mode:s.Scale.FIT,autoCenter:s.Scale.CENTER_BOTH,fullscreenTarget:"game-container",parent:"game-container"},scene:[i,o,f]};new s.Game(w);
